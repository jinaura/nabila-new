{% assign _settings = section.settings %}

<section class="evergreen-video">
  <div class="container section__item section_spacing">
    <div class="text-container">
      <h3>{{_settings.title}}</h3>
      <p>{{_settings.description}}</p>
      <div>
        <a href="{{_settings.button_link_1}}">{{_settings.button_label_1}}</a>
        <a href="{{_settings.button_link_2}}">{{_settings.button_label_2}}</a>
      </div>
    </div>

    {% if _settings.section_link %}<a href="{{ _settings.section_link }}">{% endif %}
      <div class="iframe-container animate hidden-xs">
        {% if _settings.video_url.type == 'youtube' %}
          <iframe  class="responsive-iframe" width="560" height="315" src="https://www.youtube.com/embed/{{_settings.video_url.id}}?playlist={{_settings.video_url.id}}&loop=1&autoplay=1&mute=1" title="{{_settings.title}}" fetchpriority="low" loading="lazy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        {% elsif _settings.video_url.type == 'vimeo' %}
          <iframe  class="responsive-iframe" width="560" height="315" src="https://player.vimeo.com/video/{{_settings.video_url.id}}" title="{{_settings.title}}" fetchpriority="low" loading="lazy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        {% elsif _settings.custom_video_url %}
          <video
            id="evergreenplayer"
            autoplay="autoplay"
            loop=""
            muted
            preload="auto"
            width="100%"
            height="100%"
            playsinline="true" webkit-playsinline="true"
            data-setup='{"width": 300, "height": 250}' class="responsive-iframe"
            title="{{ _settings.video_alt_text }}">
            <source src="{{ _settings.custom_video_url }}" type='video/mp4' />
          </video>
          <div>
            <input type="checkbox" id="evergreen-pause-play-switcher">
            <label id="evergreen-pause-play-switcher-container" for="evergreen-pause-play-switcher"></label> 
          </div>
        {% endif %}
      </div>
      <div class="iframe-container animate hidden-sm hidden-md hidden-lg">
        {% if _settings.m_video_url.type == 'youtube' %}
          <iframe  class="responsive-iframe" width="560" height="315" src="https://www.youtube.com/embed/{{_settings.m_video_url.id}}?playlist={{_settings.m_video_url.id}}&loop=1&autoplay=1&mute=1" title="{{_settings.title}}" fetchpriority="low" loading="lazy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        {% elsif _settings.m_video_url.type == 'vimeo' %}
          <iframe  class="responsive-iframe" width="560" height="315" src="https://player.vimeo.com/video/{{_settings.m_video_url.id}}" title="{{_settings.title}}" fetchpriority="low" loading="lazy" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        {% elsif _settings.m_custom_video_url %}
          <video
            id="evergreenmobileplayer"
            autoplay="autoplay"
            loop=""
            muted
            preload="auto"
            width="100%"
            height="100%"
            playsinline="true" webkit-playsinline="true"
            data-setup='{"width": 300, "height": 250}' class="responsive-iframe"
            title="{{ _settings.video_alt_text }}">
            <source src="{{ _settings.m_custom_video_url }}" type='video/mp4' />
          </video>
          <div>
            <input type="checkbox" id="evergreen-mobile-pause-play-switcher">
            <label id="evergreen-mobile-pause-play-switcher-container" for="evergreen-mobile-pause-play-switcher"></label> 
          </div>
        {% endif %}
      </div>
    {% if _settings.section_link %}</a>{% endif %}
  </div>
  <div class="container">
    <hr class="section__divider" />
  </div>
</section>

<style>
  .evergreen-video .section_spacing {
    padding-top: 40px;
    position: relative;
  }
  .evergreen-video .section_spacing .text-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: absolute;
    width: 100%;
    height: 100%;
    justify-content: center;
    z-index: 1;
    padding-right: 30px;
    padding-left: 30px;
    padding-bottom: 40px;
  }
  .evergreen-video .section_spacing .text-container h3 {
    color: {{section.settings.title_color}};
    font-size: 26px;
    letter-spacing: 1.86px;
    line-height: 30px;
  }
  .evergreen-video .section_spacing .text-container p {
    color: {{section.settings.description_color}};
    font-size: 22px;
    letter-spacing: 1.57px;
    line-height: 1.2;
    margin-top: 10px;
  }
  .evergreen-video .section_spacing .text-container a {
    color: {{section.settings.button_links_color}};
    font-family: var(--font-medium);
    font-size: 14px;
    letter-spacing: 1px;
    text-decoration: none;
    border-bottom: 2px solid;
    text-transform: uppercase;
  }
  .evergreen-video .section_spacing .text-container a:first-child {
    margin-right: 30px;
  }
  .evergreen-video .iframe-container {
    padding-top: 15.2%;
  }
  .evergreen-video .responsive-iframe {
    object-fit: cover;
    object-position: center;
  }
  input#evergreen-pause-play-switcher,
  input#evergreen-mobile-pause-play-switcher {
    position: absolute;
    visibility: hidden;
    pointer-events: none;
  }
  #evergreen-pause-play-switcher-container,
  #evergreen-mobile-pause-play-switcher-container  {
    display: block;
    position: absolute;
    bottom: 38px;
    right: 38px;
    z-index: 2;
    cursor: pointer;
    -webkit-transition: all 0.3s ease-in;
    -moz-transition: all 0.3s ease-in;
    transition: all 0.3s ease-in 0s;
  }
  #evergreen-pause-play-switcher-container:after,
  #evergreen-mobile-pause-play-switcher-container:after {
    content: "";
    border: 0px solid black;
    background: url({{ 'pause.png' | asset_url }}) center center;
    background-size: 100%;
    position: absolute;
    width: 18px;
    height: 18px;
    filter: invert(1)
  }
  #evergreen-pause-play-switcher:checked + #evergreen-pause-play-switcher-container:after,
  #evergreen-mobile-pause-play-switcher:checked + #evergreen-mobile-pause-play-switcher-container:after {
    content: "";
    background: url({{ 'play-button.png' | asset_url }}) center center;
    background-size: 100%;
    filter: invert(1);
    width: 18px;
  }
  .evergreen-video hr.section__divider {
    margin-top: 80px;
  }

  @media (max-width: 1100px) {
    .evergreen-video .iframe-container {
      padding-top: 20%;
    }
  }
  @media (max-width: 900px) {
    .evergreen-video .iframe-container {
      padding-top: 30%;
    }
  }
  @media (max-width: 767px) {
    .evergreen-video .section_spacing {
      padding-left: 0;
      padding-right: 0;
      padding-top: 20px;
      margin-bottom: 40px;
    }
    .evergreen-video .section_spacing .text-container {
      padding-right: 15px;
      padding-left: 15px;
      padding-bottom: 20px;
    }
    .evergreen-video .section_spacing .text-container h3, .evergreen-video .section_spacing .text-container p {
      font-size: 16px;
      letter-spacing: 1.14px;
      line-height: 20px;
    }
    .evergreen-video .section_spacing .text-container p {
      margin-top: 0;
      margin-bottom: 22px;
    }
    .evergreen-video .iframe-container {
      margin-bottom: 18px;
      padding-top: 48%;
    }
    .evergreen-video hr.section__divider {
      display: none;
    }
  }
</style>

<script>
  document.querySelector("#evergreen-pause-play-switcher").onchange = function() {
    if (this.checked){
      document.querySelector("#evergreenplayer").pause();
    } else{
      document.querySelector("#evergreenplayer").play();
    }
  }
  document.querySelector("#evergreen-mobile-pause-play-switcher").onchange = function() {
    if (this.checked){
      document.querySelector("#evergreenmobileplayer").pause();
    } else{
      document.querySelector("#evergreenmobileplayer").play();
    }
  }           
</script>

{% schema %}
    {
    "name": "Evergreen Video Module",
    "settings": [
      {
        "type": "url",
        "id": "section_link",
        "label": "Section link url"
      },
      {
        "type": "text",
        "id": "title",
        "label": "Title"
      },
      {
        "type": "color",
        "id": "title_color",
        "label": "Title color",
        "default": "#ffffff"
      },
      {
        "type": "text",
        "id": "description",
        "label": "Description"
      },
      {
        "type": "color",
        "id": "description_color",
        "label": "Description color",
        "default": "#ffffff"
      },
      {
        "type": "text",
        "id": "button_label_1",
        "label": "First button label",
        "default": "Learn more"
      },
      {
        "type": "url",
        "id": "button_link_1",
        "label": "First button link url"
      },
      {
        "type": "text",
        "id": "button_label_2",
        "label": "Second button label",
        "default": "Shop now"
      },
      {
        "type": "url",
        "id": "button_link_2",
        "label": "Second button link url"
      },
      {
        "type": "color",
        "id": "button_links_color",
        "label": "Button links color",
        "default": "#ffffff"
      },
      {
        "id": "video_url",
        "type": "video_url",
        "label": "Video URL",
        "accept": ["youtube", "vimeo"]
      },
      {
        "type": "text",
        "id": "custom_video_url",
        "label": "Custom Video Url"
      },
      {
        "type": "text",
        "id": "video_alt_text",
        "label": "Video Alt Text"
      },
      {
        "id": "m_video_url",
        "type": "video_url",
        "label": "Mobile Video URL",
        "accept": ["youtube", "vimeo"]
      },
      {
        "type": "text",
        "id": "m_custom_video_url",
        "label": "Mobile Custom Video Url"
      }
    ],
    "blocks" : [],
    "presets": [
      {
        "name": "Evergreen Video Module",
        "category": "Text"
      }
    ]
    }
{% endschema %}